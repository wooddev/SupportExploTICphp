
{# src/Explotic/MainBundle/Resources/views/Form/fields.html.twig #}
 
{% block gmaps_picker_widget %}</pre>
<div id="gmaps_picker_widget">
<div id="input">{{ block('form_widget') }}</div>
<div id="map_canvas" style="width:800px; height:400px"></div>
</div>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB4hT13IYCchS-xzh54W5_fUZv8kad8GOo&sensor=false"></script>
<script type="text/javascript" src="{{asset('bundles/sonatajquery/jquery-1.8.0.js')}}"></script>
<script type="text/javascript">
var map;
function initialize() {
    var myLatLng = new google.maps.LatLng(55,-0.45);
    var mapOptions = {
        zoom : 4,
        center : myLatLng,        
        mapTypeId : google.maps.MapTypeId.ROADMAP
        }
    map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);

    google.maps.event.addListener(map, 'click', function(event) {
      placeMarker(event.latLng);
    });
}

var marker;
function placeMarker(location) {
    if(marker) {//v√©rif si le marker existe
        marker.setPosition(location); // on change sa position
    }
    else{
        marker = new google.maps.Marker({
            position : location,
            map : map
        });
    
    map.setCenter(location);    
    }
    document.getElementById({{form.lat.vars.id}}).value = location.lat();
    document.getElementById({{form.lon.vars.id}}).value = location.lng();
}


google.maps.event.addDomListener(window,'load',initialize);

</script>


{% endblock %}